

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="[[weixin_44954504]]">
  <meta name="keywords" content="java,博客,vue,spring,mysql,docker,linux">
  
    <meta name="description" content="文章浏览阅读746次，点赞4次，收藏11次。Activiti 是一个工作流引擎，它可以将业务系统中复杂的业务流程抽取出来，使用专门的建模语言 BPMN2.0 进行定义，业务流程按照预先定义的流程进行执行，实现了系统的流程由 Activiti 进行管理，减少业务系统由于流程变更进行系统升级改造的工作量，从而提高系统的健壮性，同时也减少了系统开发维护成本。截至2025.3官方最新版本是8.x，较于7.">
<meta property="og:type" content="article">
<meta property="og:title" content="Activiti 8.x 工作流入门（含demo）">
<meta property="og:url" content="https://yhao521.github.io/2025/09/29/%E6%91%98%E5%BD%95/Activiti%208.x%20%E5%B7%A5%E4%BD%9C%E6%B5%81%E5%85%A5%E9%97%A8%EF%BC%88%E5%90%ABdemo%EF%BC%89/index.html">
<meta property="og:site_name" content="匆匆过客的博客">
<meta property="og:description" content="文章浏览阅读746次，点赞4次，收藏11次。Activiti 是一个工作流引擎，它可以将业务系统中复杂的业务流程抽取出来，使用专门的建模语言 BPMN2.0 进行定义，业务流程按照预先定义的流程进行执行，实现了系统的流程由 Activiti 进行管理，减少业务系统由于流程变更进行系统升级改造的工作量，从而提高系统的健壮性，同时也减少了系统开发维护成本。截至2025.3官方最新版本是8.x，较于7.">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-09-29T14:38:25.000Z">
<meta property="article:modified_time" content="2026-01-21T15:01:04.679Z">
<meta property="article:author" content="yhao521">
<meta property="article:tag" content="摘录">
<meta property="article:tag" content="教程">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Activiti 8.x 工作流入门（含demo） - 匆匆过客的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"yhao521.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null},"woyaola":null,"cnzz":null},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>匆匆过客的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/bg.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Activiti 8.x 工作流入门（含demo）"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-09-29 22:38" pubdate>
          2025年9月29日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8.7k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          73 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Activiti 8.x 工作流入门（含demo）</h1>
            
            
              <div class="markdown-body">
                
                <p><strong>目录</strong></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t0">1. 简介</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t1">2. BPMN2.0</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t2">3. SpringBoot集成Activiti8</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t3">3.1. 关键依赖</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t4">3.2. 完整pom文件</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t5">3.3. 关键配置</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t6">3.4. 配置SpringSecurity</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t7">3.5. 表解读</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t8">3.5.1. 全局通用表</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t9">3.5.2. 历史数据表</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t10">3.5.3. 静态资源表</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t11">3.5.4. 运行时数据表</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t12">4. 基本操作</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t13">4.1. 流程部署</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t14">4.1.1. 部署流程</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t15">4.1.2. 查询流程定义</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t16">4.2. 流程实例</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t17">4.2.1. 发起流程实例</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t18">4.2.2. 查询流程实例</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t19">4.2.3. 流程实例的挂起与激活</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t20">4.2.4. 删除流程实例</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t21">4.3. 任务管理</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t22">4.3.1. 查询任务</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t23">4.3.2. 执行任务</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t24">4.3.3. 添加批注</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t25">4.3.4. 任务的拾取与归还</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t26">4.3.5. 任务的交办&#x2F;转办</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t27">4.3.6. 任务的委派</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t28">4.4. 历史记录</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t29">4.5. UEL表达式</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t30">4.6. BPMN2.0网关</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t31">4.6.1. 并行网关（Parallel Gateway）</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/#t32">4.6.2. 排他网关（Exclusive gateway）</a></p>
<h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><p>Activiti 是一个 工作流引擎 ，它可以将业务系统中复杂的业务流程抽取出来，使用专门的建模语言 BPMN2.0 进行定义，业务流程按照预先定义的流程进行执行，实现了系统的流程由 Activiti 进行管理，减少业务系统由于流程变更进行系统升级改造的工作量，从而提高系统的健壮性，同时也减少了系统开发维护成本。截至2025.3官方最新版本是8.x，较于7.x版本增加了对SpringBoot3.x版本的生态支持。</p>
<p>官方网站: <a target="_blank" rel="noopener" href="https://www.activiti.org/" title="Open Source Business Automation | Activiti">Open Source Business Automation | Activiti</a></p>
<p>它的主要service如下：</p>
<p>![[_resources&#x2F;d714522fceeae1639ce39b64defae319_MD5.png]]</p>
<h2 id="2-BPMN2-0"><a href="#2-BPMN2-0" class="headerlink" title="2. BPMN2.0"></a>2. BPMN2.0</h2><p>BPMN（Business Process Model And Notation），业务流程模型和符号，是由BPMI（Business Process Management Initiative）开发的一套的业务流程建模符号，使用BPMN提供的符号可以创建业务流程。2004年5月发布了BPMN1.0规范。BPMI于2005年9月并入OMG（The Object Management Group，对象管理组织）组织。OMG于2011年1月发布BPMN2.0的最终版本。</p>
<p>Activit就是使用BPMN2.0进行流程建模、流程执行管理，它包括很多的建模符号。</p>
<p>![[_resources&#x2F;6864f5e008ef376446b6dec9677397b3_MD5.png]]</p>
<p>举个栗子：</p>
<ol>
<li>当事人填写请假单，启动流程后把请假单ID绑定到流程中；</li>
<li>部门经理对请假单进行审核；</li>
<li>然后人事经理进行复核并进行备案；</li>
<li>最后请假流程结束</li>
</ol>
<p>![[_resources&#x2F;bc7a22f43a8574862fcec1f7533d6cd9_MD5.png]]</p>
<p>其对应的bpmn文件如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs cobol">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br><br>&lt;definitions xmlns=&quot;http://www.omg.org/spec/BPMN/20100524/MODEL&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:activiti=&quot;http://activiti.org/bpmn&quot; xmlns:bpmndi=&quot;http://www.omg.org/spec/BPMN/20100524/DI&quot; xmlns:omgdc=&quot;http://www.omg.org/spec/DD/20100524/DC&quot; xmlns:omgdi=&quot;http://www.omg.org/spec/DD/20100524/DI&quot; typeLanguage=&quot;http://www.w3.org/2001/XMLSchema&quot; expressionLanguage=&quot;http://www.w3.org/1999/XPath&quot; targetNamespace=&quot;http://www.activiti.org/processdef&quot;&gt;<br><br>  &lt;process id=&quot;leave&quot; name=&quot;请假流程&quot; isExecutable=&quot;true&quot;&gt;<br><br>    &lt;startEvent id=&quot;sid-5093280b-01bd-4e25-b0a1-8d7a5c3fbd04&quot; name=&quot;start&quot;&gt;<br><br>      &lt;documentation&gt;start&lt;/documentation&gt;<br><br>    &lt;/startEvent&gt;<br><br>    &lt;userTask id=&quot;sid-1c4676e3-a321-4577-958f-4f58338ca30f&quot; name=&quot;部门经理审批&quot;/&gt;<br><br>    &lt;endEvent id=&quot;sid-31bf179d-0e5d-4247-819c-fcec8bbf0dcf&quot; name=&quot;end&quot;&gt;<br><br>      &lt;documentation&gt;end&lt;/documentation&gt;<br><br>    &lt;/endEvent&gt;<br><br>    &lt;userTask id=&quot;sid-8b644537-23e0-4b11-a6a7-b2ab3e9c672f&quot; name=&quot;人事复批&quot;/&gt;<br><br>    &lt;sequenceFlow id=&quot;sid-79e3137d-f940-4da2-9f88-a9948c880398&quot; sourceRef=&quot;sid-5093280b-01bd-4e25-b0a1-8d7a5c3fbd04&quot; targetRef=&quot;sid-1c4676e3-a321-4577-958f-4f58338ca30f&quot;/&gt;<br><br>    &lt;sequenceFlow id=&quot;sid-4ea4d53f-15c5-447e-adee-bdc3afedcf8d&quot; sourceRef=&quot;sid-1c4676e3-a321-4577-958f-4f58338ca30f&quot; targetRef=&quot;sid-8b644537-23e0-4b11-a6a7-b2ab3e9c672f&quot;/&gt;<br><br>    &lt;sequenceFlow id=&quot;sid-987322e4-0127-408b-8e31-9cbf8aef59ac&quot; sourceRef=&quot;sid-8b644537-23e0-4b11-a6a7-b2ab3e9c672f&quot; targetRef=&quot;sid-31bf179d-0e5d-4247-819c-fcec8bbf0dcf&quot;/&gt;<br><br>  &lt;/process&gt;<br><br>  &lt;bpmndi:BPMNDiagram id=&quot;BPMNDiagram_leave&quot;&gt;<br><br>    &lt;bpmndi:BPMNPlane bpmnElement=&quot;leave&quot; id=&quot;BPMNPlane_leave&quot;&gt;<br><br>      &lt;bpmndi:BPMNShape id=&quot;shape-fa730c4a-d8fb-40eb-9d59-820dae226bc5&quot; bpmnElement=&quot;sid-5093280b-01bd-4e25-b0a1-8d7a5c3fbd04&quot;&gt;<br><br>        &lt;omgdc:Bounds x=&quot;-80.0&quot; y=&quot;9.5&quot; width=&quot;30.0&quot; height=&quot;30.0&quot;/&gt;<br><br>      &lt;/bpmndi:BPMNShape&gt;<br><br>      &lt;bpmndi:BPMNShape id=&quot;shape-91f5616b-c6eb-460b-a5c8-5484205f8dc4&quot; bpmnElement=&quot;sid-1c4676e3-a321-4577-958f-4f58338ca30f&quot;&gt;<br><br>        &lt;omgdc:Bounds x=&quot;-5.0&quot; y=&quot;-15.5&quot; width=&quot;100.0&quot; height=&quot;80.0&quot;/&gt;<br><br>      &lt;/bpmndi:BPMNShape&gt;<br><br>      &lt;bpmndi:BPMNShape id=&quot;shape-c5c32bb0-6ae1-412e-8bea-aa762aaec71c&quot; bpmnElement=&quot;sid-31bf179d-0e5d-4247-819c-fcec8bbf0dcf&quot;&gt;<br><br>        &lt;omgdc:Bounds x=&quot;285.0&quot; y=&quot;9.5&quot; width=&quot;30.0&quot; height=&quot;30.0&quot;/&gt;<br><br>      &lt;/bpmndi:BPMNShape&gt;<br><br>      &lt;bpmndi:BPMNShape id=&quot;shape-e5ab4f02-c479-475f-81ad-13347e442556&quot; bpmnElement=&quot;sid-8b644537-23e0-4b11-a6a7-b2ab3e9c672f&quot;&gt;<br><br>        &lt;omgdc:Bounds x=&quot;140.0&quot; y=&quot;-15.5&quot; width=&quot;100.0&quot; height=&quot;80.0&quot;/&gt;<br><br>      &lt;/bpmndi:BPMNShape&gt;<br><br>      &lt;bpmndi:BPMNEdge id=&quot;edge-bce72f21-997b-426c-87b0-bae4a889f33f&quot; bpmnElement=&quot;sid-79e3137d-f940-4da2-9f88-a9948c880398&quot;&gt;<br><br>        &lt;omgdi:waypoint x=&quot;-50.0&quot; y=&quot;24.5&quot;/&gt;<br><br>        &lt;omgdi:waypoint x=&quot;-5.0&quot; y=&quot;24.5&quot;/&gt;<br><br>      &lt;/bpmndi:BPMNEdge&gt;<br><br>      &lt;bpmndi:BPMNEdge id=&quot;edge-207689ac-79a2-4011-b446-845c982d859e&quot; bpmnElement=&quot;sid-4ea4d53f-15c5-447e-adee-bdc3afedcf8d&quot;&gt;<br><br>        &lt;omgdi:waypoint x=&quot;95.0&quot; y=&quot;24.5&quot;/&gt;<br><br>        &lt;omgdi:waypoint x=&quot;140.0&quot; y=&quot;24.5&quot;/&gt;<br><br>      &lt;/bpmndi:BPMNEdge&gt;<br><br>      &lt;bpmndi:BPMNEdge id=&quot;edge-4d3dbdef-8cb8-482d-94e9-7264ba7fe60a&quot; bpmnElement=&quot;sid-987322e4-0127-408b-8e31-9cbf8aef59ac&quot;&gt;<br><br>        &lt;omgdi:waypoint x=&quot;240.0&quot; y=&quot;24.5&quot;/&gt;<br><br>        &lt;omgdi:waypoint x=&quot;285.0&quot; y=&quot;24.5&quot;/&gt;<br><br>      &lt;/bpmndi:BPMNEdge&gt;<br><br>    &lt;/bpmndi:BPMNPlane&gt;<br><br>  &lt;/bpmndi:BPMNDiagram&gt;<br><br>&lt;/definitions&gt;<br></code></pre></td></tr></table></figure>

<p>在Idea中，可以选用插件“Activiti BPMN visualizer”，其具体操作不做具体讲解。</p>
<h2 id="3-SpringBoot集成Activiti8"><a href="#3-SpringBoot集成Activiti8" class="headerlink" title="3. SpringBoot集成Activiti8"></a>3. SpringBoot集成Activiti8</h2><p>本示例所选用的SpringBoot版本是3.4.1、activiti选择的版本是8.4.0、jdk-22。因为官方依赖矩阵不明确，所以建议选用和笔者一致的版本。</p>
<p>ps：如何有官方提供的依赖矩阵，请评论告诉我，我是没找到。</p>
<h3 id="3-1-关键依赖"><a href="#3-1-关键依赖" class="headerlink" title="3.1. 关键依赖"></a>3.1. 关键依赖</h3><p>自activiti7.1.x版本官方不再将构建制品发布到 maven 中央仓库了，而是发布在了alfresco仓库，这就需要我们仓库才能正确下载依赖，在pom中添加repositories标签，然后再添加repository标签。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cobol">&lt;repositories&gt;<br><br>  &lt;repository&gt;<br><br>    &lt;id&gt;activiti-releases&lt;/id&gt;<br><br>    &lt;url&gt;https://artifacts.alfresco.com/nexus/content/repositories/activiti-releases&lt;/url&gt;<br><br>  &lt;/repository&gt;<br><br>&lt;/repositories&gt;<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cobol">&lt;dependency&gt;<br><br>  &lt;groupId&gt;org.activiti&lt;/groupId&gt;<br><br>  &lt;artifactId&gt;activiti-spring-boot-starter&lt;/artifactId&gt;<br><br>  &lt;version&gt;8.4.0&lt;/version&gt;<br><br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure>

<h3 id="3-2-完整pom文件"><a href="#3-2-完整pom文件" class="headerlink" title="3.2. 完整pom文件"></a>3.2. 完整pom文件</h3><p>除了activiti的核心依赖，还有数据库引擎依赖，此处将完整的pom文件列出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><code class="hljs cobol">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br><br>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br><br>  xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;<br><br>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;<br><br>  &lt;parent&gt;<br><br>    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br><br>    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;<br><br>    &lt;version&gt;3.4.1&lt;/version&gt;<br><br>    &lt;relativePath/&gt;<br><br>  &lt;/parent&gt;<br><br> <br><br>  &lt;groupId&gt;com.zz&lt;/groupId&gt;<br><br>  &lt;artifactId&gt;sb-activiti&lt;/artifactId&gt;<br><br>  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;<br><br>  &lt;name&gt;sb-mybatis&lt;/name&gt;<br><br>  &lt;description&gt;sb-activiti&lt;/description&gt;<br><br>  &lt;properties&gt;<br><br>    &lt;java.version&gt;22&lt;/java.version&gt;<br><br>  &lt;/properties&gt;<br><br>  <br><br>  &lt;dependencies&gt;<br><br>    &lt;dependency&gt;<br><br>      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br><br>      &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;<br><br>    &lt;/dependency&gt;<br><br> <br><br>    &lt;dependency&gt;<br><br>      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br><br>      &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;<br><br>      &lt;scope&gt;test&lt;/scope&gt;<br><br>    &lt;/dependency&gt;<br><br> <br><br>    &lt;dependency&gt;<br><br>      &lt;groupId&gt;com.mysql&lt;/groupId&gt;<br><br>      &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;<br><br>      &lt;scope&gt;runtime&lt;/scope&gt;<br><br>    &lt;/dependency&gt;<br><br> <br><br>    &lt;dependency&gt;<br><br>      &lt;groupId&gt;com.baomidou&lt;/groupId&gt;<br><br>      &lt;artifactId&gt;mybatis-plus-spring-boot3-starter&lt;/artifactId&gt;<br><br>      &lt;version&gt;3.5.10.1&lt;/version&gt;<br><br>    &lt;/dependency&gt;<br><br> <br><br>    &lt;dependency&gt;<br><br>      &lt;groupId&gt;org.activiti&lt;/groupId&gt;<br><br>      &lt;artifactId&gt;activiti-spring-boot-starter&lt;/artifactId&gt;<br><br>    &lt;/dependency&gt;<br><br> <br><br>  &lt;/dependencies&gt;<br><br> <br><br>  &lt;repositories&gt;<br><br>    &lt;repository&gt;<br><br>      &lt;id&gt;aliyun-releases&lt;/id&gt;<br><br>      &lt;name&gt;阿里云仓库&lt;/name&gt;<br><br>      &lt;url&gt;https://maven.aliyun.com/repository/public&lt;/url&gt;<br><br>    &lt;/repository&gt;<br><br>    &lt;repository&gt;<br><br>      &lt;id&gt;activiti-releases&lt;/id&gt;<br><br>      &lt;url&gt;https://artifacts.alfresco.com/nexus/content/repositories/activiti-releases&lt;/url&gt;<br><br>    &lt;/repository&gt;<br><br>  &lt;/repositories&gt;<br><br> <br><br>  &lt;build&gt;<br><br>    &lt;plugins&gt;<br><br>      &lt;plugin&gt;<br><br>        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br><br>        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;<br><br>      &lt;/plugin&gt;<br><br>    &lt;/plugins&gt;<br><br>  &lt;/build&gt;<br><br> <br><br>&lt;/project&gt;<br></code></pre></td></tr></table></figure>

<h3 id="3-3-关键配置"><a href="#3-3-关键配置" class="headerlink" title="3.3. 关键配置"></a>3.3. 关键配置</h3><p>既然是SpringBoot集成，配置文件当然可以写在application.yaml文件中，此处列出常用配置和相关注释：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cobol">spring:<br><br>  application:<br><br>    name: sb-mybatis<br><br>  datasource:<br><br>    driver-class-name: com.mysql.cj.jdbc.Driver<br><br>    type: com.zaxxer.hikari.HikariDataSource<br><br>    url: jdbc:mysql://localhost:3306/temp?useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC&amp;characterEncoding=UTF8&amp;nullCatalogMeansCurrent=true<br><br>    username: root<br><br>    password: lei19960711<br><br>  activiti:<br><br>    db-history-used: true<br><br>    history-level: full<br><br>    database-schema-update: true<br><br>    check-process-definitions: false<br><br>    deployment-mode: never-fail<br><br>    async-executor-activate： false<br></code></pre></td></tr></table></figure>
<ul>
<li>db-history-used：数据库历史表是否启用，默认为false，建议改为true</li>
<li>history-level：记录历史记录，可配置的历史级别包括：</li>
<li><ul>
<li>none：不记录任何历史信息，流程执行中最高效。<ul>
<li>activity：级别高于none，保存流程实例与流程行为，其他数据不保存。</li>
<li>audit：除activity级别会保存的数据外，还会保存全部的流程任务及其属性。audit为history的默认值。</li>
<li>full：保存历史数据的最高级别，除了会保存audit级别的数据外，还会保存其他全部流程相关的细节数据，包括一些流程参数等。</li>
</ul>
</li>
</ul>
</li>
<li>database-schema-update：数据库更新操作，可选项包括：</li>
<li><ul>
<li>false：activiti在启动时，对比数据库表中保存的版本，如果没有表或者版本不匹配，将抛出异常。<ul>
<li>true：默认值，activiti会对数据库中所有表进行更新操作。如果表不存在，则自动创建。</li>
<li>create_drop： 在activiti启动时创建表，在关闭时删除表（必须手动关闭引擎，才能删除表）。</li>
<li>drop-create： 在activiti启动时删除原来的旧表，然后在创建新表（不需要手动关闭引擎）。</li>
</ul>
</li>
</ul>
</li>
<li>check-process-definitions：校验流程文件，默认校验resources下的processes文件夹里的流程文件。</li>
<li>deployment-mode：定义流程部署失败时的处理策略。</li>
<li><ul>
<li>never-fail：关闭 SpringAutoDeployment。<ul>
<li>default：默认。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="3-4-配置SpringSecurity"><a href="#3-4-配置SpringSecurity" class="headerlink" title="3.4. 配置SpringSecurity"></a>3.4. 配置SpringSecurity</h3><p>activiti内置了SpringSecurity安全框架，需要配置UserDetailsService Bean。这里不做过多配置，仅配置该bean即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoApplicationConfiguration</span> &#123;<br><br> <br><br>    <span class="hljs-meta">@Bean</span><br><br>    <span class="hljs-keyword">public</span> UserDetailsService <span class="hljs-title function_">userDetailsService</span><span class="hljs-params">()</span> &#123;<br><br>        User.<span class="hljs-type">UserBuilder</span> <span class="hljs-variable">users</span> <span class="hljs-operator">=</span> User.withDefaultPasswordEncoder();<br><br>        <span class="hljs-type">UserDetails</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> users.username(<span class="hljs-string">&quot;user&quot;</span>)<br><br>                .password(<span class="hljs-string">&quot;&#123;noop&#125;pass&quot;</span>)<br><br>                .authorities(<span class="hljs-string">&quot;ROLE_ACTIVITI_USER&quot;</span>)<br><br>                .build();<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryUserDetailsManager</span>(user);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>UserDetailsService 用于配置用户及其各自的组和角色。需要 ACTIVITI_USER 角色才能与 Activiti 的 TaskRuntime API 进行交互。</p>
<h3 id="3-5-表解读"><a href="#3-5-表解读" class="headerlink" title="3.5. 表解读"></a>3.5. 表解读</h3><p>至此，启动SpringBoot后会在指定的数据库中自动创建activiti的25张表！！！</p>
<p>![[_resources&#x2F;bd284e7ea918fd1e453652a859386d65_MD5.png]]</p>
<p>Activiti 使用到的表都是 ACT_ 开头的，表名的第二部分表示用途。</p>
<ul>
<li>ACT_GE_ （GE） 表示 general 全局通用数据及设置，各种情况都使用的数据。</li>
<li>ACT_HI_ （HI） 表示 history 历史数据表，包含着程执行的历史相关数据。</li>
<li>ACT_RE_ （RE） 表示 repository 存储，包含的是静态信息。</li>
<li>ACT_RU_ （RU） 表示 runtime 运行时，运行时的流程变量，用户任务，变量，职责（job）等运行时数据。</li>
</ul>
<h4 id="3-5-1-全局通用表"><a href="#3-5-1-全局通用表" class="headerlink" title="3.5.1. 全局通用表"></a>3.5.1. 全局通用表</h4><table>
<thead>
<tr>
<th><strong>表名</strong></th>
<th><strong>解释</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ACT_GE_BYTEARRAY</td>
<td>二进制 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E8%A1%A8&spm=1001.2101.3001.7020">数据表</a> ，存储通用的流程定义和流程资源。</td>
</tr>
<tr>
<td>ACT_GE_PROPERTY</td>
<td>系统相关属性，属性数据表存储整个流程引擎级别的数据。</td>
</tr>
</tbody></table>
<p>act_ge_bytearray：</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段描述</th>
<th>数据类型</th>
<th>主键</th>
<th>为空</th>
<th>取值说明</th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>Y</td>
<td></td>
<td>主键ID</td>
</tr>
<tr>
<td>REV_</td>
<td>乐观锁</td>
<td>int</td>
<td></td>
<td>Y</td>
<td>Version(版本)</td>
</tr>
<tr>
<td>NAME_</td>
<td>名称</td>
<td>nvarchar(255)</td>
<td></td>
<td>Y</td>
<td>部署的文件名称，如：leave.bpmn.png,leave.bpmn20.xml</td>
</tr>
<tr>
<td>DEPLOYMENT_ID_</td>
<td>部署ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>Y</td>
<td>部署表ID</td>
</tr>
<tr>
<td>BYTES_</td>
<td>字节</td>
<td>varbinary</td>
<td></td>
<td>Y</td>
<td>部署文件</td>
</tr>
<tr>
<td>GENERATED_</td>
<td>是否是引擎生成</td>
<td>tinyint</td>
<td></td>
<td>Y</td>
<td>0为用户生成，1为activiti生成</td>
</tr>
</tbody></table>
<p>act_ge_property：略</p>
<h4 id="3-5-2-历史数据表"><a href="#3-5-2-历史数据表" class="headerlink" title="3.5.2. 历史数据表"></a>3.5.2. 历史数据表</h4><table>
<thead>
<tr>
<th><strong>表名</strong></th>
<th><strong>解释</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ACT_HI_ACTINST</td>
<td>历史节点表</td>
</tr>
<tr>
<td>ACT_HI_ATTACHMENT</td>
<td>历史附件表</td>
</tr>
<tr>
<td>ACT_HI_COMMENT</td>
<td>历史意见表</td>
</tr>
<tr>
<td>ACT_HI_DETAIL</td>
<td>历史详情表，提供历史变量的查询</td>
</tr>
<tr>
<td>ACT_HI_IDENTITYLINK</td>
<td>历史流程人员表</td>
</tr>
<tr>
<td>ACT_HI_PROCINST</td>
<td>历史流程实例表</td>
</tr>
<tr>
<td>ACT_HI_TASKINST</td>
<td>历史任务实例表</td>
</tr>
<tr>
<td>ACT_HI_VARINST</td>
<td>历史变量表</td>
</tr>
</tbody></table>
<p>act_hi_actinst：历史活动信息。这里记录流程流转过的所有节点，与HI_TASKINST不同的是，taskinst只记录usertask内容</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段描述</th>
<th>数据类型</th>
<th>主键</th>
<th>为空</th>
<th>取值说明</th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td>流程定义ID</td>
<td>nvarchar(64)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td>执行实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ACT_ID_</td>
<td>节点ID</td>
<td>nvarchar(225)</td>
<td></td>
<td></td>
<td>节点定义ID</td>
</tr>
<tr>
<td>TASK_ID_</td>
<td>任务实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>任务实例ID 其他节点类型实例ID在这里为空</td>
</tr>
<tr>
<td>CALL_PROC_INST_ID_</td>
<td>调用外部的流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>调用外部流程的流程实例ID’</td>
</tr>
<tr>
<td>ACT_NAME_</td>
<td>节点名称</td>
<td>nvarchar(225)</td>
<td></td>
<td>√</td>
<td>节点定义名称</td>
</tr>
<tr>
<td>ACT_TYPE_</td>
<td>节点类型</td>
<td>nvarchar(225)</td>
<td></td>
<td></td>
<td>如startEvent、userTask</td>
</tr>
<tr>
<td>ASSIGNEE_</td>
<td>签收人</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>节点签收人</td>
</tr>
<tr>
<td>START_TIME_</td>
<td>开始时间</td>
<td>datetime</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>END_TIME_</td>
<td>结束时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>DURATION_</td>
<td>耗时</td>
<td>numeric(19,0)</td>
<td></td>
<td>√</td>
<td>毫秒值</td>
</tr>
<tr>
<td>DELETE_REASON_</td>
<td></td>
<td>nvarchar(4000)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>nvarchar(225)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>act_hi_attachment：历史附件表</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段描述</th>
<th>数据类型</th>
<th>主键</th>
<th>为空</th>
<th>取值说明</th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>主键ID</td>
</tr>
<tr>
<td>REV_</td>
<td>乐观锁</td>
<td>integer</td>
<td></td>
<td>√</td>
<td>Version</td>
</tr>
<tr>
<td>USER_ID_</td>
<td>用户ID</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>用户ID</td>
</tr>
<tr>
<td>NAME_</td>
<td>名称</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>附件名称</td>
</tr>
<tr>
<td>DESCRIPTION_</td>
<td>描述</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>描述</td>
</tr>
<tr>
<td>TYPE_</td>
<td>类型</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>附件类型</td>
</tr>
<tr>
<td>TASK_ID_</td>
<td>任务实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>节点实例ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>URL_</td>
<td>URL_</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>附件地址</td>
</tr>
<tr>
<td>CONTENT_ID_</td>
<td>字节表的ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>ACT_GE_BYTEARRAY的ID</td>
</tr>
<tr>
<td>TIME_</td>
<td></td>
<td>datetime</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody></table>
<p>act_hi_comment：历史意见表</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段描述</th>
<th>数据类型</th>
<th>主键</th>
<th>为空</th>
<th>取值说明</th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>主键ID</td>
</tr>
<tr>
<td>TYPE_</td>
<td>类型</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>类型：event（事件）comment（意见）</td>
</tr>
<tr>
<td>TIME_</td>
<td>时间</td>
<td>datetime</td>
<td></td>
<td></td>
<td>填写时间’</td>
</tr>
<tr>
<td>USER_ID_</td>
<td>用户ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>填写人</td>
</tr>
<tr>
<td>TASK_ID_</td>
<td>节点任务ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>节点实例ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>ACTION_</td>
<td>行为类型</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>见备注1</td>
</tr>
<tr>
<td>MESSAGE_</td>
<td>基本内容</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>用于存放流程产生的信息，比如审批意见</td>
</tr>
<tr>
<td>FULL_MSG_</td>
<td>全部内容</td>
<td>varbinary(max)</td>
<td></td>
<td>√</td>
<td>附件地址</td>
</tr>
</tbody></table>
<p>act_hi_detail：历史详情表：流程中产生的变量详细，包括控制流程流转的变量，业务表单中填写的流程需要用到的变量等。</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段描述</th>
<th>数据类型</th>
<th>主键</th>
<th>为空</th>
<th>取值说明</th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>主键</td>
</tr>
<tr>
<td>TYPE_</td>
<td>类型</td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td>见备注2</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td>执行实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>执行实例ID</td>
</tr>
<tr>
<td>TASK_ID_</td>
<td>任务实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>任务实例ID</td>
</tr>
<tr>
<td>ACT_INST_ID_</td>
<td>节点实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>ACT_HI_ACTINST表的ID</td>
</tr>
<tr>
<td>NAME_</td>
<td>名称</td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td>名称</td>
</tr>
<tr>
<td>VAR_TYPE_</td>
<td>参数类型</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>见备注3</td>
</tr>
<tr>
<td>REV_</td>
<td>乐观锁</td>
<td>int</td>
<td></td>
<td>√</td>
<td>Version</td>
</tr>
<tr>
<td>TIME_</td>
<td>时间戳</td>
<td>datetime</td>
<td></td>
<td></td>
<td>创建时间</td>
</tr>
<tr>
<td>BYTEARRAY_ID_</td>
<td>字节表ID</td>
<td>nvarchar</td>
<td></td>
<td>√</td>
<td>ACT_GE_BYTEARRAY表的ID</td>
</tr>
<tr>
<td>DOUBLE_</td>
<td>DOUBLE_</td>
<td>double precision</td>
<td></td>
<td>√</td>
<td>存储变量类型为Double</td>
</tr>
<tr>
<td>LONG_</td>
<td>LONG_</td>
<td>numeric</td>
<td></td>
<td>√</td>
<td>存储变量类型为long</td>
</tr>
<tr>
<td>TEXT_</td>
<td>TEXT_</td>
<td>nvarchar</td>
<td></td>
<td>√</td>
<td>存储变量值类型为String</td>
</tr>
<tr>
<td>TEXT2_</td>
<td>TEXT2_</td>
<td>nvarchar</td>
<td></td>
<td>√</td>
<td>此处存储的是JPA持久化对象时，才会有值。此值为对象ID</td>
</tr>
</tbody></table>
<p>act_ru_identitylink：历史流程人员表：任务参与者数据表。主要存储历史节点参与者的信息</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段描述</th>
<th>数据类型</th>
<th>主键</th>
<th>为空</th>
<th>取值说明</th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>ID_</td>
</tr>
<tr>
<td>GROUP_ID_</td>
<td>组ID</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>组ID</td>
</tr>
<tr>
<td>TYPE_</td>
<td>类型</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>备注4</td>
</tr>
<tr>
<td>USER_ID_</td>
<td>用户ID</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>用户ID</td>
</tr>
<tr>
<td>TASK_ID_</td>
<td>节点实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>节点实例ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
</tbody></table>
<p>act_hi_procinst：流程实例表</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段描述</th>
<th>数据类型</th>
<th>主键</th>
<th>为空</th>
<th>取值说明</th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>主键ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td></td>
<td>流程实例ID</td>
</tr>
<tr>
<td>BUSINESS_KEY_</td>
<td>业务主键</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>业务主键，业务表单的ID</td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td>流程定义ID</td>
<td>nvarchar(64)</td>
<td></td>
<td></td>
<td>流程定义ID</td>
</tr>
<tr>
<td>START_TIME_</td>
<td>开始时间</td>
<td>datetime</td>
<td></td>
<td></td>
<td>开始时间</td>
</tr>
<tr>
<td>END_TIME_</td>
<td>结束时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>结束时间</td>
</tr>
<tr>
<td>DURATION_</td>
<td>耗时</td>
<td>Numeric(19)</td>
<td></td>
<td>√</td>
<td>耗时</td>
</tr>
<tr>
<td>START_USER_ID_</td>
<td>起草人</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>起草人</td>
</tr>
<tr>
<td>START_ACT_ID_</td>
<td>开始节点ID</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>起草环节ID</td>
</tr>
<tr>
<td>END_ACT_ID_</td>
<td>结束节点ID</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>结束环节ID</td>
</tr>
<tr>
<td>SUPER_PROCESS_INSTANCE_ID_</td>
<td>父流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>父流程实例ID</td>
</tr>
<tr>
<td>DELETE_REASON_</td>
<td>删除原因</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>删除原因</td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>NAME_</td>
<td></td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>act_hi_taskinst：历史任务示例表</p>
<table>
<thead>
<tr>
<th>字段名称</th>
<th>字段描述</th>
<th>数据类型</th>
<th>主键</th>
<th>为空</th>
<th>取值说明</th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>主键ID</td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td>流程定义ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程定义ID</td>
</tr>
<tr>
<td>TASK_DEF_KEY_</td>
<td>节点定义ID</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>节点定义ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td>执行实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>执行实例ID</td>
</tr>
<tr>
<td>NAME_</td>
<td>名称</td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td>名称</td>
</tr>
<tr>
<td>PARENT_TASK_ID_</td>
<td>父节点实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>父节点实例ID</td>
</tr>
<tr>
<td>DESCRIPTION_</td>
<td>描述</td>
<td>nvarchar(400)</td>
<td></td>
<td>√</td>
<td>描述</td>
</tr>
<tr>
<td>OWNER_</td>
<td>实际签收人 任务的拥有者</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>签收人（默认为空，只有在委托时才有值）</td>
</tr>
<tr>
<td>ASSIGNEE_</td>
<td>签收人或被委托</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>签收人或被委托</td>
</tr>
<tr>
<td>START_TIME_</td>
<td>开始时间</td>
<td>datetime</td>
<td></td>
<td></td>
<td>开始时间</td>
</tr>
<tr>
<td>CLAIM_TIME_</td>
<td>提醒时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>提醒时间</td>
</tr>
<tr>
<td>END_TIME_</td>
<td>结束时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>结束时间</td>
</tr>
<tr>
<td>DURATION_</td>
<td>耗时</td>
<td>numeric(19)</td>
<td></td>
<td>√</td>
<td>耗时</td>
</tr>
<tr>
<td>DELETE_REASON_</td>
<td>删除原因</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>删除原因(completed,deleted)</td>
</tr>
<tr>
<td>PRIORITY_</td>
<td>优先级别</td>
<td>int</td>
<td></td>
<td>√</td>
<td>优先级别</td>
</tr>
<tr>
<td>DUE_DATE_</td>
<td>过期时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>过期时间，表明任务应在多长时间内完成</td>
</tr>
<tr>
<td>FORM_KEY_</td>
<td>节点定义的formkey</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>desinger节点定义的form_key属性</td>
</tr>
<tr>
<td>CATEGORY_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody></table>
<p>act_hi_varinst：历史变量表。</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>ID_</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td>执行实例ID</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>执行实例ID</td>
</tr>
<tr>
<td>TASK_ID_</td>
<td>任务实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>任务实例ID</td>
</tr>
<tr>
<td>NAME_</td>
<td>名称</td>
<td>nvarchar(64)</td>
<td></td>
<td></td>
<td>参数名称(英文)</td>
</tr>
<tr>
<td>VAR_TYPE_</td>
<td>参数类型</td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td>备注5</td>
</tr>
<tr>
<td>REV_</td>
<td>乐观锁</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>乐观锁 Version</td>
</tr>
<tr>
<td>BYTEARRAY_ID_</td>
<td>字节表ID</td>
<td>nvarchar(400)</td>
<td></td>
<td>√</td>
<td>ACT_GE_BYTEARRAY表的主键</td>
</tr>
<tr>
<td>DOUBLE_</td>
<td>DOUBLE_</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>存储DoubleType类型的数据</td>
</tr>
<tr>
<td>LONG_</td>
<td>LONG_</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>存储LongType类型的数据</td>
</tr>
<tr>
<td>TEXT_</td>
<td>TEXT_</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>备注6</td>
</tr>
<tr>
<td>TEXT2_</td>
<td>TEXT2_</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>此处存储的是JPA持久化对象时，才会有值。此值为对象ID</td>
</tr>
<tr>
<td>CREATE_TIME_</td>
<td></td>
<td>datetime</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>LAST_UPDATED_TIME_</td>
<td></td>
<td>datetime</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="3-5-3-静态资源表"><a href="#3-5-3-静态资源表" class="headerlink" title="3.5.3. 静态资源表"></a>3.5.3. 静态资源表</h4><table>
<thead>
<tr>
<th><strong>表名</strong></th>
<th><strong>解释</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ACT_RE_DEPLOYMENT</td>
<td>部署信息表</td>
</tr>
<tr>
<td>ACT_RE_MODEL</td>
<td>流程设计 模型 部署表</td>
</tr>
<tr>
<td>ACT_RE_PROCDEF</td>
<td>流程定义数据表</td>
</tr>
</tbody></table>
<p>act_re_deployment：部署流程定义时需要被持久化保存下来的信息。</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>主键ID</td>
</tr>
<tr>
<td>NAME_</td>
<td>部署名称</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>部署文件名</td>
</tr>
<tr>
<td>CATEGORY_</td>
<td>分类</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>类别</td>
</tr>
<tr>
<td>KEY_</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>DEPLOY_TIME_</td>
<td>部署时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>部署时间</td>
</tr>
<tr>
<td>ENGINE_VERSION_</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>act_re_model：流程设计器设计流程后，保存数据到该表。</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>ID_</td>
</tr>
<tr>
<td>REV_</td>
<td>乐观锁</td>
<td>int</td>
<td></td>
<td>√</td>
<td>乐观锁</td>
</tr>
<tr>
<td>NAME_</td>
<td>名称</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>名称</td>
</tr>
<tr>
<td>KEY_</td>
<td>KEY_</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>key</td>
</tr>
<tr>
<td>CATEGORY_</td>
<td>分类</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>分类</td>
</tr>
<tr>
<td>CREATE_TIME_</td>
<td>创建时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>创建时间</td>
</tr>
<tr>
<td>LAST_UPDATE_TIME_</td>
<td>最新修改时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>最新修改时间</td>
</tr>
<tr>
<td>VERSION_</td>
<td>版本</td>
<td>int</td>
<td></td>
<td>√</td>
<td>版本</td>
</tr>
<tr>
<td>META_INFO_</td>
<td>META_INFO_</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>以json格式保存流程定义的信息</td>
</tr>
<tr>
<td>DEPLOYMENT_ID_</td>
<td>部署ID</td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td>部署ID</td>
</tr>
<tr>
<td>EDITOR_SOURCE_VALUE_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EDITOR_SOURCE_EXTRA_VALUE_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>act_re_procdef：业务流程定义数据表。此表和 ACT_RE_DEPLOYMENT 是多对一的关系，即，一个部署的bar包里可能包含多个流程定义文件，每个流程定义文件都会有一条记录在 ACT_REPROCDEF 表内，每个流程定义的数据，都会对应 ACT_GE_BYTEARRAY 表内的一个资源文件和 PNG 图片文件。和 ACT_GE_BYTEARRAY 的关联是通过程序用ACT_GE_BYTEARRAY.NAME 与 ACT_RE_PROCDEF.NAME 完成的，在数据库表结构中没有体现。</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>ID_</td>
</tr>
<tr>
<td>REV_</td>
<td>乐观锁</td>
<td>int</td>
<td></td>
<td>√</td>
<td>乐观锁</td>
</tr>
<tr>
<td>CATEGORY_</td>
<td>分类</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>流程定义的Namespace就是类别</td>
</tr>
<tr>
<td>NAME_</td>
<td>名称</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>名称</td>
</tr>
<tr>
<td>KEY_</td>
<td>定义的KEY</td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td>流程定义ID</td>
</tr>
<tr>
<td>VERSION_</td>
<td>版本</td>
<td>int</td>
<td></td>
<td></td>
<td>版本</td>
</tr>
<tr>
<td>DEPLOYMENT_ID_</td>
<td>部署表ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>部署表ID</td>
</tr>
<tr>
<td>RESOURCE_NAME_</td>
<td>bpmn文件名称</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>流程bpmn文件名称</td>
</tr>
<tr>
<td>DGRM_RESOURCE_NAME_</td>
<td>png图片名称</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>流程图片名称</td>
</tr>
<tr>
<td>DESCRIPTION_</td>
<td>描述</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>描述</td>
</tr>
<tr>
<td>HAS_START_FORM_KEY</td>
<td>是否存在开始节点formKey</td>
<td>tinyint</td>
<td></td>
<td>√</td>
<td>start节点是否存在formKey 0否 1是</td>
</tr>
<tr>
<td>SUSPENSION_STATE_</td>
<td>是否挂起</td>
<td>tinyint</td>
<td></td>
<td>√</td>
<td>1 激活 2挂起</td>
</tr>
<tr>
<td>HAS_GRAPHICAL_NOTATION_</td>
<td></td>
<td>tinyint</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ENGINE_VERSION_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="3-5-4-运行时数据表"><a href="#3-5-4-运行时数据表" class="headerlink" title="3.5.4. 运行时数据表"></a>3.5.4. 运行时数据表</h4><table>
<thead>
<tr>
<th><strong>表名</strong></th>
<th><strong>解释</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ACT_RU_DEADLETTER_JOB</td>
<td>无法执行工作表： 如果一个任务执行了很多次，都无法执行，那么这个任务会写到</td>
</tr>
<tr>
<td>ACT_RU_EXECUTION</td>
<td>运行时流程执行实例</td>
</tr>
<tr>
<td>ACT_RU_EVENT_SUBSCR</td>
<td>运行时事件 throwEvent、catchEvent 时间监听信息表</td>
</tr>
<tr>
<td>ACT_RU_IDENTITYLINK</td>
<td>运行时流程人员表，主要存储任务节点与参与者的相关信息</td>
</tr>
<tr>
<td>ACT_RU_INTEGRATION</td>
<td>运行时积分表</td>
</tr>
<tr>
<td>ACT_RU_JOB</td>
<td>运行时定时任务数据表</td>
</tr>
<tr>
<td>ACT_RU_SUSPENDED_JOB</td>
<td>暂停的工作，流程中有一个定时任务，如果把这个任务停止工作了，这个任务会在act_ru_suspended_job中写入数据</td>
</tr>
<tr>
<td>ACT_RU_TASK</td>
<td>运行时任务节点表</td>
</tr>
<tr>
<td>ACT_RU_TIMER_JOB</td>
<td>运行时定时器作业表</td>
</tr>
<tr>
<td>ACT_RU_VARIABLE</td>
<td>运行时流程变量数据表</td>
</tr>
</tbody></table>
<p>act_ru_deadletter_job：</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>varchar(64)</td>
<td>√</td>
<td></td>
<td>ID_</td>
</tr>
<tr>
<td>REV_</td>
<td></td>
<td>int</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TYPE_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EXCLUSIVE_</td>
<td></td>
<td>tinyint(1)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>PROCESS_INSTANCE_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EXCEPTION_STACK_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EXCEPTION_MSG_</td>
<td></td>
<td>varchar(4000)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>DUEDATE_</td>
<td></td>
<td>timestamp</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>REPEAT_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>HANDLER_TYPE_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>HANDLER_CFG_</td>
<td></td>
<td>varchar(4000)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody></table>
<p>act_ru_event_subscr：</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>事件ID</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>事件ID</td>
</tr>
<tr>
<td>REV_</td>
<td>版本</td>
<td>int</td>
<td></td>
<td>√</td>
<td>乐观锁Version</td>
</tr>
<tr>
<td>EVENT_TYPE_</td>
<td>事件类型</td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td>事件类型</td>
</tr>
<tr>
<td>EVENT_NAME_</td>
<td>事件名称</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>事件名称</td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td>执行实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>执行实例ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>ACTIVITY_ID_</td>
<td>活动实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>活动实例ID</td>
</tr>
<tr>
<td>CONFIGURATION_</td>
<td>配置</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>配置</td>
</tr>
<tr>
<td>CREATED_</td>
<td>是否创建</td>
<td>datetime</td>
<td></td>
<td></td>
<td>默认值 当前系统时间戳CURRENT_TIMESTAMP</td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody></table>
<p>act_ru_execution：运行时流程执行实例表</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>事件ID</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>事件ID</td>
</tr>
<tr>
<td>REV_</td>
<td>版本</td>
<td>int</td>
<td></td>
<td>√</td>
<td>乐观锁Version</td>
</tr>
<tr>
<td>EVENT_TYPE_</td>
<td>事件类型</td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td>事件类型</td>
</tr>
<tr>
<td>EVENT_NAME_</td>
<td>事件名称</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>事件名称</td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td>执行实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>执行实例ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>ACTIVITY_ID_</td>
<td>活动实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>活动实例ID</td>
</tr>
<tr>
<td>CONFIGURATION_</td>
<td>配置</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>配置</td>
</tr>
<tr>
<td>CREATED_</td>
<td>是否创建</td>
<td>datetime</td>
<td></td>
<td></td>
<td>默认值 当前系统时间戳CURRENT_TIMESTAMP</td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody></table>
<p>act_ru_identitylink：运行时流程人员表：任务参与者数据表。主要存储当前节点参与者的信息。</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>ID_</td>
</tr>
<tr>
<td>REV_</td>
<td>乐观锁</td>
<td>int</td>
<td></td>
<td>√</td>
<td>乐观锁</td>
</tr>
<tr>
<td>GROUP_ID_</td>
<td>组ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>组ID</td>
</tr>
<tr>
<td>TYPE_</td>
<td>类型</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>备注7</td>
</tr>
<tr>
<td>USER_ID_</td>
<td>用户ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>用户ID</td>
</tr>
<tr>
<td>TASK_ID_</td>
<td>节点实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>节点实例ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td>流程定义ID</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>流程定义ID</td>
</tr>
</tbody></table>
<p>act_ru_integration：</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td></td>
<td>varchar(64)</td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>PROCESS_INSTANCE_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>FLOW_NODE_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>CREATED_DATE_</td>
<td></td>
<td>timestamp</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody></table>
<p>act_ru_job：运行时定时任务数据表( act_ru_job )</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>标识</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>标识</td>
</tr>
<tr>
<td>REV_</td>
<td>版本</td>
<td>int</td>
<td></td>
<td>√</td>
<td>版本</td>
</tr>
<tr>
<td>TYPE_</td>
<td>类型</td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td>类型</td>
</tr>
<tr>
<td>LOCK_EXP_TIME_</td>
<td>锁定释放时间</td>
<td>锁定释放时间</td>
<td></td>
<td>√</td>
<td>锁定释放时间</td>
</tr>
<tr>
<td>LOCK_OWNER_</td>
<td>挂起者</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>挂起者</td>
</tr>
<tr>
<td>EXCLUSIVE_</td>
<td></td>
<td>bit</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td>执行实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>执行实例ID</td>
</tr>
<tr>
<td>PROCESS_INSTANCE_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td>流程定义ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程定义ID</td>
</tr>
<tr>
<td>RETRIES_</td>
<td></td>
<td>int</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EXCEPTION_STACK_ID_</td>
<td>异常信息ID</td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td>异常信息ID</td>
</tr>
<tr>
<td>EXCEPTION_MSG_</td>
<td>异常信息</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>异常信息</td>
</tr>
<tr>
<td>DUEDATE_</td>
<td>到期时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>到期时间</td>
</tr>
<tr>
<td>REPEAT_</td>
<td>重复</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>重复</td>
</tr>
<tr>
<td>HANDLER_TYPE_</td>
<td>处理类型</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>处理类型</td>
</tr>
<tr>
<td>HANDLER_CFG_</td>
<td></td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>标识</td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>act_ru_suspended_job：</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td></td>
<td>varchar(64)</td>
<td>√</td>
<td></td>
<td></td>
</tr>
<tr>
<td>REV_</td>
<td></td>
<td>int</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>TYPE_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>EXCLUSIVE_</td>
<td></td>
<td>tinyint(1)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>PROCESS_INSTANCE_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>RETRIES_</td>
<td></td>
<td>int</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EXCEPTION_STACK_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>EXCEPTION_MSG_</td>
<td></td>
<td>varchar(4000)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>DUEDATE_</td>
<td></td>
<td>timestamp</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>REPEAT_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>HANDLER_TYPE_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>HANDLER_CFG_</td>
<td></td>
<td>varchar(4000)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody></table>
<p>act_ru_task ：运行时任务节点表</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>ID_</td>
</tr>
<tr>
<td>REV_</td>
<td>乐观锁</td>
<td>int</td>
<td></td>
<td>√</td>
<td>乐观锁</td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td>执行实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>执行实例ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td>流程定义ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程定义ID</td>
</tr>
<tr>
<td>NAME_</td>
<td>节点定义名称</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>节点定义名称</td>
</tr>
<tr>
<td>PARENT_TASK_ID_</td>
<td>父节点实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>父节点实例ID</td>
</tr>
<tr>
<td>DESCRIPTION_</td>
<td>节点定义描述</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>节点定义描述</td>
</tr>
<tr>
<td>TASK_DEF_KEY_</td>
<td>节点定义的KEY</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>任务定义的ID</td>
</tr>
<tr>
<td>OWNER_</td>
<td>实际签收人</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>拥有者（一般情况下为空，只有在委托时才有值）</td>
</tr>
<tr>
<td>ASSIGNEE_</td>
<td>签收人或委托人</td>
<td>nvarchar(255)</td>
<td></td>
<td>√</td>
<td>签收人或委托人</td>
</tr>
<tr>
<td>DELEGATION_</td>
<td>委托类型</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>备注8</td>
</tr>
<tr>
<td>PRIORITY_</td>
<td>优先级别</td>
<td>int</td>
<td></td>
<td>√</td>
<td>优先级别，默认为：50</td>
</tr>
<tr>
<td>CREATE_TIME_</td>
<td>创建时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>创建时间</td>
</tr>
<tr>
<td>DUE_DATE_</td>
<td>过期时间</td>
<td>datetime</td>
<td></td>
<td>√</td>
<td>耗时</td>
</tr>
<tr>
<td>CATEGORY_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>SUSPENSION_STATE_</td>
<td>是否挂起</td>
<td>int</td>
<td></td>
<td>√</td>
<td>1代表激活 2代表挂起</td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td></td>
</tr>
<tr>
<td>FORM_KEY_</td>
<td>节点表单KEY</td>
<td>varchar(255)</td>
<td></td>
<td>√</td>
<td>节点表单key</td>
</tr>
<tr>
<td>CLAIM_TIME_</td>
<td></td>
<td>datetime</td>
<td></td>
<td>√</td>
<td></td>
</tr>
</tbody></table>
<p>act_ru_timer_job：</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>REV_</td>
<td></td>
<td>int</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TYPE_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>LOCK_EXP_TIME_</td>
<td></td>
<td>timestamp</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>LOCK_OWNER_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>EXCLUSIVE_</td>
<td></td>
<td>tinyint(1)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>PROCESS_INSTANCE_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>PROC_DEF_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>RETRIES_</td>
<td></td>
<td>int</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>EXCEPTION_STACK_ID_</td>
<td></td>
<td>varchar(64)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>EXCEPTION_MSG_</td>
<td></td>
<td>varchar(4000)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>DUEDATE_</td>
<td></td>
<td>timestamp</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>REPEAT_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>HANDLER_TYPE_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>HANDLER_CFG_</td>
<td></td>
<td>varchar(4000)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TENANT_ID_</td>
<td></td>
<td>varchar(255)</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>act_ru_variable ：运行时流程变量数据表</p>
<table>
<thead>
<tr>
<th><strong>字段名称</strong></th>
<th><strong>字段描述</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>主键</strong></th>
<th><strong>为空</strong></th>
<th><strong>取值说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>ID_</td>
<td>ID_</td>
<td>nvarchar(64)</td>
<td>√</td>
<td></td>
<td>主键标识</td>
</tr>
<tr>
<td>REV_</td>
<td>乐观锁</td>
<td>int</td>
<td></td>
<td>√</td>
<td>乐观锁</td>
</tr>
<tr>
<td>TYPE_</td>
<td>类型</td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td>备注9</td>
</tr>
<tr>
<td>NAME_</td>
<td>名称</td>
<td>nvarchar(255)</td>
<td></td>
<td></td>
<td>变量名称</td>
</tr>
<tr>
<td>EXECUTION_ID_</td>
<td>执行实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>执行的ID</td>
</tr>
<tr>
<td>PROC_INST_ID_</td>
<td>流程实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>流程实例ID</td>
</tr>
<tr>
<td>TASK_ID_</td>
<td>节点实例ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>节点实例ID(Local）</td>
</tr>
<tr>
<td>BYTEARRAY_ID_</td>
<td>字节表ID</td>
<td>nvarchar(64)</td>
<td></td>
<td>√</td>
<td>字节表的ID（ACT_GE_BYTEARRAY）</td>
</tr>
<tr>
<td>DOUBLE_</td>
<td>DOUBLE_</td>
<td>float</td>
<td></td>
<td>√</td>
<td>存储变量类型为Double</td>
</tr>
<tr>
<td>LONG_</td>
<td>LONG_</td>
<td>numeric(19)</td>
<td></td>
<td>√</td>
<td>存储变量类型为long</td>
</tr>
<tr>
<td>TEXT_</td>
<td>TEXT_</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>‘存储变量值类型为String 如此处存储持久化对象时，值jpa对象的class</td>
</tr>
<tr>
<td>TEXT2_</td>
<td>TEXT2_</td>
<td>nvarchar(4000)</td>
<td></td>
<td>√</td>
<td>此处存储的是JPA持久化对象时，才会有值。此值为对象</td>
</tr>
</tbody></table>
<h2 id="4-基本操作"><a href="#4-基本操作" class="headerlink" title="4. 基本操作"></a>4. 基本操作</h2><h3 id="4-1-流程部署"><a href="#4-1-流程部署" class="headerlink" title="4.1. 流程部署"></a>4.1. 流程部署</h3><p>流程部署分为自动部署和手动部署</p>
<ul>
<li><em>自动部署</em> ：将 <code>bpmn</code> 文件放入 <code>resources</code> 资源目录下的 <code>processes</code> 文件夹中，项目启动时则进行自动部署。check-process-definitions需设置为true。</li>
<li><em>手动部署</em> ：新建测试类，并编写流程部署测试方法。</li>
</ul>
<h4 id="4-1-1-部署流程"><a href="#4-1-1-部署流程" class="headerlink" title="4.1.1. 部署流程"></a>4.1.1. 部署流程</h4><p>需要使用RepositoryService部署流程定义。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs csharp">@Service<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TestDemo</span> &#123;<br><br>    <br><br>    @Autowired<br><br>    <span class="hljs-keyword">private</span> RepositoryService repositoryService;<br><br>    <br><br>    <span class="hljs-comment">// 测试部署</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Deployment <span class="hljs-title">deploy</span>()</span> &#123;<br><br><span class="hljs-comment">//        // 获取 ProcessEngine 流程引擎</span><br><br><span class="hljs-comment">//        ProcessEngine processEngine = ProcessEngines.getDefaultProcessEngine();</span><br><br><span class="hljs-comment">//        // 获取RepositoryService</span><br><br><span class="hljs-comment">//        RepositoryService repositoryService = processEngine.getRepositoryService();</span><br><br>        <br><br>        <span class="hljs-comment">// 进行部署</span><br><br>        Deployment deploy = repositoryService.createDeployment()<br><br>                .addClasspathResource(<span class="hljs-string">&quot;bpmn/leave.bpmn20.xml&quot;</span>)<br><br>                .name(<span class="hljs-string">&quot;请假流程&quot;</span>)<br><br>                .deploy();<br><br> <br><br>        System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程部署id:\&#123;deploy.getId()&#125;&quot;</span>);<br><br>        System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程部署name:\&#123;deploy.getName()&#125;&quot;</span>);<br><br>        <span class="hljs-keyword">return</span> deploy;<br><br>    &#125;<br><br> <br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Deployment <span class="hljs-title">deployZip</span>()</span> &#123;<br><br>        InputStream inputStream = <span class="hljs-keyword">this</span>.getClass()<br><br>                .getClassLoader()<br><br>                .getResourceAsStream(<span class="hljs-string">&quot;bpmn/leave.bpmn20.zip&quot;</span>);<br><br>        ZipInputStream zipInputStream = <span class="hljs-keyword">new</span> ZipInputStream(inputStream);<br><br>        Deployment deploy = repositoryService.createDeployment()<br><br>                .addZipInputStream(zipInputStream)<br><br>                .name(<span class="hljs-string">&quot;请假流程-zip&quot;</span>)<br><br>                .deploy();<br><br>        System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程部署id:\&#123;deploy.getId()&#125;&quot;</span>);<br><br>        System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程部署name:\&#123;deploy.getName()&#125;&quot;</span>);<br><br>        <span class="hljs-keyword">return</span> deploy;<br><br>    &#125;<br><br> <br><br>    <span class="hljs-comment">// 查询流程部署列表</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getDeploymentList</span>()</span> &#123;<br><br>        List&lt;Deployment&gt; deployments = repositoryService.createDeploymentQuery().list();<br><br>        <span class="hljs-keyword">if</span> (!deployments.isEmpty()) &#123;<br><br>            deployments.forEach(deployment -&gt; &#123;<br><br>                System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;Id：\&#123;deployment.getId()&#125;&quot;</span>);<br><br>                System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;Name：\&#123;deployment.getName()&#125;&quot;</span>);<br><br>                System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;DeploymentTime：\&#123;deployment.getDeploymentTime()&#125;&quot;</span>);<br><br>                System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;Key：\&#123;deployment.getKey()&#125;&quot;</span>);<br><br>            &#125;);<br><br>        &#125;<br><br>    &#125;<br><br> <br><br>    <span class="hljs-comment">// 删除流程部署</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deleteDeployment</span>()</span> &#123;<br><br>        String deploymentId = <span class="hljs-string">&quot;0f1cf913-0c4c-11f0-88fe-002b672ee8ea&quot;</span>;<br><br>        repositoryService.deleteDeployment(deploymentId, <span class="hljs-literal">false</span>);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到在SpringBoot中使用 repositoryService 非常方便，直接使用IOC容器中的bean即可。如果在非容器环境中，需要先获得ProcessEngine流程引擎，然后再通过ProcessEngine得到 repositoryService，进而进行部署。</p>
<p>涉及数据表：act_re_deployment、act_re_procdef、act_ge_bytearray、act_ru_identitylink</p>
<h4 id="4-1-2-查询流程定义"><a href="#4-1-2-查询流程定义" class="headerlink" title="4.1.2. 查询流程定义"></a>4.1.2. 查询流程定义</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">// 查询流程定义列表</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getProcessDefinition</span>()</span> &#123;<br><br>    List&lt;ProcessDefinition&gt; list = repositoryService.createProcessDefinitionQuery().list();<br><br>    <span class="hljs-keyword">for</span> (ProcessDefinition processDefinition : list) &#123;<br><br>        System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程定义key：\&#123;processDefinition.getKey()&#125;&quot;</span>);<br><br>        System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程定义name：\&#123;processDefinition.getName()&#125;&quot;</span>);<br><br>        System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程部署id：\&#123;processDefinition.getDeploymentId()&#125;&quot;</span>);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>上述例子知识列举了一个最简单的列表查询，此外关于流程定义在实际应用中，还有很多更为高级的查询方式：</p>
<ul>
<li>active()：查询激活状态的流程定义</li>
<li>latestVersion()：查询version字段最新的流程定义</li>
<li>processDefinitionKey()：根据流程定义的key查询</li>
<li>processDefinitionId()：根据流程定义的id查询</li>
<li>processDefinitionIdOrKey()：根据流程定义的id或key查询</li>
</ul>
<h3 id="4-2-流程实例"><a href="#4-2-流程实例" class="headerlink" title="4.2. 流程实例"></a>4.2. 流程实例</h3><h4 id="4-2-1-发起流程实例"><a href="#4-2-1-发起流程实例" class="headerlink" title="4.2.1. 发起流程实例"></a>4.2.1. 发起流程实例</h4><p>在部署了流程定义之后，接下来就是发起流程实例。</p>
<p>针对上述的流程，启动一个流程实例相当于发起一个请假申请单，这就相当于Java类和Java对象的关系，类定义好之后需要new创建一个对象使用，当然，也可以new多个对象。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs csharp">@Autowired<br><br><span class="hljs-keyword">private</span> RuntimeService runtimeService;<br><br> <br><br><span class="hljs-comment">// 启动流程实例</span><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startProcessInstance</span>()</span> &#123;<br><br>    String processDefinitionKey = <span class="hljs-string">&quot;leave&quot;</span>;<br><br>    ProcessInstance processInstance = runtimeService.startProcessInstanceByKey(processDefinitionKey);<br><br>    System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程实例id：\&#123;processInstance.getProcessInstanceId()&#125;&quot;</span>);<br><br>    System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程实例的businessKey：\&#123;processInstance.getBusinessKey()&#125;&quot;</span>);<br><br>    System.<span class="hljs-keyword">out</span>.println(STR.<span class="hljs-string">&quot;流程定义id：\&#123;processInstance.getProcessDefinitionId()&#125;&quot;</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>runtimeService可直接从容器中获取，然后可以调用startProcessInstanceByKey()方法启动一个流程实例，这个方法必须传入流程定义的key-processDefinitionKey，此外还以传入：</p>
<ul>
<li>businessKey：业务key，将流程实例和业务数据关联起来。</li>
<li>variables：动态传入的参数，可作为后续分支流转的条件。</li>
</ul>
<p>涉及数据表：act_hi_actinst、act_hi_taskinst、act_hi_identitylink、act_hi_procinst、act_ru_execution、act_ru_identitylink、act_ru_task</p>
<h4 id="4-2-2-查询流程实例"><a href="#4-2-2-查询流程实例" class="headerlink" title="4.2.2. 查询流程实例"></a>4.2.2. 查询流程实例</h4><p>和流程定义一样，流程实例的查询也可以有多种方式，比如下面例子中例举了最常见的几种查询方式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cobol">// 查询流程实例<br><br>public void getProcessInstance() &#123;<br><br>    // 通过流程定义key查询<br><br>    String processDefinitionKey = &quot;leave&quot;;<br><br>    List&lt;ProcessInstance&gt; list = runtimeService.createProcessInstanceQuery()<br><br>    .processDefinitionKey(processDefinitionKey).list();<br><br>    for (ProcessInstance processInstance : list) &#123;<br><br>        System.out.println(processInstance.getProcessInstanceId());<br><br>    &#125;<br><br> <br><br>    // 通过业务key查询<br><br>    String businessKey = &quot;zl-leave&quot;;<br><br>    List&lt;ProcessInstance&gt; list1 = runtimeService.createProcessInstanceQuery()<br><br>    .processInstanceBusinessKey(businessKey).list();<br><br>    for (ProcessInstance processInstance : list1) &#123;<br><br>        System.out.println(processInstance.getProcessInstanceId());<br><br>    &#125;<br><br> <br><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-2-3-流程实例的挂起与激活"><a href="#4-2-3-流程实例的挂起与激活" class="headerlink" title="4.2.3. 流程实例的挂起与激活"></a>4.2.3. 流程实例的挂起与激活</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// 流程实例的挂起</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">suspendProcessInstance</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">String</span> processInstanceId = <span class="hljs-string">&quot;cd81c512-0c56-11f0-828a-002b672ee8ea&quot;</span>;<br><br>    runtimeService.<span class="hljs-title function_">suspendProcessInstanceById</span>(processInstanceId);<br><br>&#125;<br><br> <br><br><span class="hljs-comment">// 流程实例的激活</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">activeProcessInstance</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">String</span> processInstanceId = <span class="hljs-string">&quot;cd81c512-0c56-11f0-828a-002b672ee8ea&quot;</span>;<br><br>    runtimeService.<span class="hljs-title function_">activateProcessInstanceById</span>(processInstanceId);<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>act_ru_task表中的SUSPENSION_STATE_字段发生变更，1代表激活、2代表挂起。</p>
<p>除了流程实例，像流程定义、任务也可以挂起和激活</p>
<h4 id="4-2-4-删除流程实例"><a href="#4-2-4-删除流程实例" class="headerlink" title="4.2.4. 删除流程实例"></a>4.2.4. 删除流程实例</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// 删除流程实例</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">deleteProcessInstance</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">String</span> processInstanceId = <span class="hljs-string">&quot;cd81c512-0c56-11f0-828a-002b672ee8ea&quot;</span>;<br><br>    <span class="hljs-title class_">String</span> deleteReason = <span class="hljs-string">&quot;不想请假了&quot;</span>;<br><br>    runtimeService.<span class="hljs-title function_">deleteProcessInstance</span>(processInstanceId, deleteReason);<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4-3-任务管理"><a href="#4-3-任务管理" class="headerlink" title="4.3. 任务管理"></a>4.3. 任务管理</h3><p>我们以最常见的UserTask为例，利用Activiti BPMN visualizer插件可以查看UserTask如下：</p>
<p>![[_resources&#x2F;1c7a68637852b9868915019ac062ada0_MD5.png]]</p>
<ul>
<li>Assignee：执行人&#x2F;代理人</li>
<li>Candidate Users：候选人</li>
<li>Candidate Groups：候选组</li>
<li>Due Date：任务到期时间</li>
</ul>
<p>涉及数据表：act_hi_actinst、act_hi_taskinst、act_hi_identitylink、act_hi_procinst、act_ru_execution、act_ru_identitylink、act_ru_task</p>
<h4 id="4-3-1-查询任务"><a href="#4-3-1-查询任务" class="headerlink" title="4.3.1. 查询任务"></a>4.3.1. 查询任务</h4><p>在任务管理时，可以查看任务列表，当然也可以根据指定的执行人查询。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cobol">@Autowired<br><br>private TaskService taskService;<br><br> <br><br>// 查询任务<br><br>public void getTask() &#123;<br><br>    // 查询任务列表<br><br>    List&lt;Task&gt; list = taskService.createTaskQuery().list();<br><br> <br><br>    // 查询某个执行人的任务<br><br>    List&lt;Task&gt; list1 = taskService.createTaskQuery().taskAssignee(&quot;张磊&quot;).list();<br><br>    <br><br>    // 查询某个执行人执行的某项任务<br><br>    List&lt;Task&gt; list2 = taskService.createTaskQuery().processDefinitionKey(&quot;leave&quot;).taskAssignee(&quot;张磊&quot;).list();<br><br>    <br><br>    // 查询没有执行人的任务<br><br>    List&lt;Task&gt; list3 = taskService.createTaskQuery().taskUnassigned().list();<br><br> <br><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-3-2-执行任务"><a href="#4-3-2-执行任务" class="headerlink" title="4.3.2. 执行任务"></a>4.3.2. 执行任务</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cobol">// 完成任务<br><br>public void completeTask() &#123;<br><br>    // 完成所有执行人为“张磊”的请假任务<br><br>    List&lt;Task&gt; list = taskService.createTaskQuery()<br><br>        .processDefinitionKey(&quot;leave&quot;)<br><br>        .taskAssignee(&quot;张磊&quot;)<br><br>        .list();<br><br> <br><br>    for (Task task : list) &#123;<br><br>        // 完成任务<br><br>        taskService.complete(task.getId());<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>在完成任务时，基本思路就是先按照流程定义key、或任务执行人、或任务id，找到待完成的任务，然后调用complete方法完成任务，其接收两个参数，分别是：</p>
<ul>
<li>taskId：任务id</li>
<li>variables：向下流转的参数</li>
</ul>
<h4 id="4-3-3-添加批注"><a href="#4-3-3-添加批注" class="headerlink" title="4.3.3. 添加批注"></a>4.3.3. 添加批注</h4><p>在执行任务之前，还可以添加批注，然后可以在后续的 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95&spm=1001.2101.3001.7020">历史记录</a> 中看到添加的批注</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cobol">// 添加批注<br><br>public void addCommend() &#123;<br><br>    String user = &quot;jack&quot;;<br><br>    List&lt;Task&gt; list = taskService.createTaskQuery().taskAssignee(user).list();<br><br>    for (Task task : list) &#123;<br><br>        String taskId = task.getId();<br><br>        String processInstanceId = task.getProcessInstanceId();<br><br>        //在任务执行之前任务添加批注信息<br><br>        taskService.addComment(taskId, processInstanceId, &quot;审批通过&quot;);<br><br>        taskService.complete(taskId);<br><br>    &#125;<br><br>&#125;<br><br> <br><br>// 查看批注<br><br>public void getCommend() &#123;<br><br>    String taskId = &quot;xxxx&quot;;<br><br>    if(taskComments.size()&gt;0)&#123;<br><br>        System.out.println(&quot;审批批注:&quot;+taskComments.get(0).getFullMessage());<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-3-4-任务的拾取与归还"><a href="#4-3-4-任务的拾取与归还" class="headerlink" title="4.3.4. 任务的拾取与归还"></a>4.3.4. 任务的拾取与归还</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// 任务拾取</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">claimTask</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">String</span> taskId = <span class="hljs-string">&quot;9409084b-0c67-11f0-a4a4-002b672ee8ea&quot;</span>;<br><br>    <span class="hljs-title class_">String</span> userId = <span class="hljs-string">&quot;wtc&quot;</span>;<br><br>    taskService.<span class="hljs-title function_">claim</span>(taskId, userId);<br><br>&#125;<br><br> <br><br><span class="hljs-comment">// 任务归还</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">returnTask</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">String</span> taskId = <span class="hljs-string">&quot;9409084b-0c67-11f0-a4a4-002b672ee8ea&quot;</span>;<br><br>    taskService.<span class="hljs-title function_">unclaim</span>(taskId);<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>假设一个任务没有指定执行人，某人则可以动态的拾取任务，也可以归还任务。落到表中对应的是act_ru_task表中的ASSIGNEE_字段。</p>
<h4 id="4-3-5-任务的交办-转办"><a href="#4-3-5-任务的交办-转办" class="headerlink" title="4.3.5. 任务的交办&#x2F;转办"></a>4.3.5. 任务的交办&#x2F;转办</h4><p>此外，除了主动是取任务，还可以被动交办任务，但其实落到表中是同一个字段。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// 交办任务</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">handoverTask</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">String</span> taskId = <span class="hljs-string">&quot;9409084b-0c67-11f0-a4a4-002b672ee8ea&quot;</span>;<br><br>    <span class="hljs-title class_">String</span> userId = <span class="hljs-string">&quot;jack&quot;</span>;<br><br>    <span class="hljs-comment">// 交办任务</span><br><br>    taskService.<span class="hljs-title function_">setAssignee</span>(taskId, userId);<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果当前已经有了任务的执行人，再次调用setAssignee方法就是更新ASSIGNEE_字段，此种场景就是任务的转办！</p>
<h4 id="4-3-6-任务的委派"><a href="#4-3-6-任务的委派" class="headerlink" title="4.3.6. 任务的委派"></a>4.3.6. 任务的委派</h4><p>任务的委派，指的是将任务转交给他人处理，当他人处理完成后，任务会自动回到当前处理人身上。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// 委派任务</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">handoverTask</span>(<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-title class_">String</span> taskId = <span class="hljs-string">&quot;9409084b-0c67-11f0-a4a4-002b672ee8ea&quot;</span>;<br><br>    <span class="hljs-title class_">String</span> userId = <span class="hljs-string">&quot;jack&quot;</span>;<br><br>    <span class="hljs-comment">// 委派任务</span><br><br>    taskService.<span class="hljs-title function_">delegateTask</span>(taskId, userId);<br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>比如，当前任务的处理人是”zl“，如果此时”zl“将任务委派给”jack“。则落到数据库中，act_ru_task表中的ASSIGNEE_字段则会变为”jack“，而OWNER_字段会变为”zl“。</p>
<p>任务到”jack“后，由其resolveTask：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Test</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">customTest</span>(<span class="hljs-params"></span>) &#123;<br><br> <br><br>    <span class="hljs-title class_">String</span> user = <span class="hljs-string">&quot;jack&quot;</span>;<br><br>    <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Task</span>&gt; list = taskService.<span class="hljs-title function_">createTaskQuery</span>().<span class="hljs-title function_">taskAssignee</span>(user).<span class="hljs-title function_">list</span>();<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Task</span> task : list) &#123;<br><br>        taskService.<span class="hljs-title function_">resolveTask</span>(task.<span class="hljs-title function_">getId</span>());<br><br>    &#125;<br><br> <br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>至此，任务就会回到”zl“处。</p>
<h3 id="4-4-历史记录"><a href="#4-4-历史记录" class="headerlink" title="4.4. 历史记录"></a>4.4. 历史记录</h3><p>利用HistoryService 自然可以查询历史记录，简单示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs cobol">@Autowired<br><br>private HistoryService historyService;<br><br> <br><br>@Test<br><br>public void history() &#123;<br><br> <br><br>    // 根据用户名查询历史记录<br><br>    String assignee = &quot;张磊&quot;;<br><br>    List&lt;HistoricTaskInstance&gt; historicTasks = this.historyService.createHistoricTaskInstanceQuery()<br><br>    .orderByHistoricTaskInstanceEndTime()<br><br>    .asc()<br><br>    .taskAssignee(assignee)<br><br>    .list();<br><br>    if (!CollectionUtils.isEmpty(historicTasks)) &#123;<br><br>        historicTasks.forEach(historicTaskInstance -&gt; &#123;<br><br>            System.out.println(STR.&quot;Id：\&#123;historicTaskInstance.getId()&#125;&quot;);<br><br>            System.out.println(STR.&quot;ProcessInstanceId：\&#123;historicTaskInstance.getProcessInstanceId()&#125;&quot;);<br><br>            System.out.println(STR.&quot;Name：\&#123;historicTaskInstance.getName()&#125;&quot;);<br><br>        &#125;);<br><br>    &#125;<br><br> <br><br>    //  根据流程实例ID查询历史<br><br>    String processInstanceId = &quot;0f8a9b00-479e-11ed-af85-e4a8dfd43d4a&quot;;<br><br>    List&lt;HistoricTaskInstance&gt; historicTasks1 = this.historyService.createHistoricTaskInstanceQuery()<br><br>    .orderByHistoricTaskInstanceEndTime()<br><br>    .asc()<br><br>    .processInstanceId(processInstanceId)<br><br>    .list();<br><br>    if (!CollectionUtils.isEmpty(historicTasks1)) &#123;<br><br>        historicTasks1.forEach(historicTaskInstance -&gt; &#123;<br><br>            System.out.println(STR.&quot;Id：\&#123;historicTaskInstance.getId()&#125;&quot;);<br><br>            System.out.println(STR.&quot;ProcessInstanceId：\&#123;historicTaskInstance.getProcessInstanceId()&#125;&quot;);<br><br>            System.out.println(STR.&quot;Name：\&#123;historicTaskInstance.getName()&#125;&quot;);<br><br>        &#125;);<br><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4-5-UEL表达式"><a href="#4-5-UEL表达式" class="headerlink" title="4.5. UEL表达式"></a>4.5. UEL表达式</h3><ul>
<li>表达式以 <code>${</code> 开始； <code>}</code> 结束，例如：${day &gt; 100}</li>
<li>支持逻辑运算：${username &#x3D;&#x3D; “admin” and password &#x3D;&#x3D; “123456”}</li>
<li>支持变量（变量名必须小写）与实体类赋值</li>
</ul>
<p>涉及数据表：act_hi_varinst、act_ru_variable</p>
<p>通常UEL表达式可用于条件网关等场景。</p>
<p>需求：根据订单金额决定是否需要经理审批。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cobol">&lt;exclusiveGateway id=&quot;approvalGateway&quot;/&gt;<br><br>&lt;sequenceFlow id=&quot;toManager&quot; sourceRef=&quot;approvalGateway&quot; targetRef=&quot;managerApproval&quot;&gt;<br><br>  &lt;conditionExpression xsi:type=&quot;tFormalExpression&quot;&gt;$&#123;order.amount &gt; 10000&#125;&lt;/conditionExpression&gt;<br><br>&lt;/sequenceFlow&gt;<br><br>&lt;sequenceFlow id=&quot;toDirect&quot; sourceRef=&quot;approvalGateway&quot; targetRef=&quot;directComplete&quot;&gt;<br><br>  &lt;conditionExpression xsi:type=&quot;tFormalExpression&quot;&gt;$&#123;order.amount &lt;= 10000&#125;&lt;/conditionExpression&gt;<br><br>&lt;/sequenceFlow&gt;<br></code></pre></td></tr></table></figure>

<h3 id="4-6-BPMN2-0网关"><a href="#4-6-BPMN2-0网关" class="headerlink" title="4.6. BPMN2.0网关"></a>4.6. BPMN2.0网关</h3><h4 id="4-6-1-并行网关（Parallel-Gateway）"><a href="#4-6-1-并行网关（Parallel-Gateway）" class="headerlink" title="4.6.1. 并行网关（Parallel Gateway）"></a>4.6.1. 并行网关（Parallel Gateway）</h4><p>![[_resources&#x2F;f90bab9a43a2d915ee8a8d7d17ea1be5_MD5.png]]</p>
<p>并行网关（Parallel Gateway）用于控制流程的 并行执行 和 同步汇聚，分为两种类型：</p>
<ul>
<li>分叉（Fork）：创建多个并行路径，流程同时进入多个分支。</li>
<li>汇聚（Join）：等待所有并行分支完成后，流程继续向下执行。</li>
</ul>
<p>在 BPMN 中，并行网关通过 <parallelGateway> 标签定义，其 ID 需在分叉和汇聚节点之间对应。</p>
<h4 id="4-6-2-排他网关（Exclusive-gateway）"><a href="#4-6-2-排他网关（Exclusive-gateway）" class="headerlink" title="4.6.2. 排他网关（Exclusive gateway）"></a>4.6.2. 排他网关（Exclusive gateway）</h4><p>![[_resources&#x2F;729b00bb2c82ed3ab6b29dc2e66d89bb_MD5.png]]</p>
<p>排他网关（Exclusive gateway）基于条件选择 唯一一条分支 执行，分支间互斥。有两点需要注意：</p>
<ul>
<li>必须定义至少一个条件分支，否则流程会报错。</li>
<li>若多个条件同时满足，默认选择第一个匹配的分支。</li>
</ul>
<p>在BPMN中，排他网关通过<exclusiveGateway>标签定义。</p>
<p>举个栗子：如上图，其中排他网关有两个分支，分别使请假&gt;5天、请假&lt;&#x3D;5天，如下：</p>
<p>![[_resources&#x2F;cc7950399e2b44b22bc3a5917a9e1978_MD5.png]]</p>
<p>![[_resources&#x2F;1f68b8f75ce6b2de004a42d8d4ee8827_MD5.png]]</p>
<p>可见在Condition expression处，填写的就是UEL表达式，而day变量则是在排他网关之前传入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cobol">@Test<br><br>public void customTest() &#123;<br><br> <br><br>    String user = &quot;zl&quot;;<br><br>    List&lt;Task&gt; list = taskService.createTaskQuery().taskAssignee(user).list();<br><br>    for (Task task : list) &#123;<br><br>        HashMap&lt;String, Object&gt; variables = new HashMap&lt;&gt;();<br><br>        variables.put(&quot;day&quot;, 10);<br><br>        taskService.complete(task.getId(), variables);<br><br>    &#125;<br><br> <br><br>&#125;<br></code></pre></td></tr></table></figure>

<p>如上，传入的day为10，所以排他网关就会走”总经理审批“这个条件分支。</p>
<hr>
<p>后续可能还会继续研究其与SpringSecurity安全框架之间的详细联系，以及关于前端框架的结合，未完待续…</p>
<p>登录后您可以享受以下权益：</p>
<ul>
<li>免费复制代码</li>
<li>和博主大V互动</li>
<li>下载海量资源</li>
<li>发动态&#x2F;写文章&#x2F;加入社区<br>×</li>
</ul>
<p>实付 元</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44954504/article/details/">使用余额支付</a></p>
<p>点击重新获取</p>
<p>扫码支付</p>
<p>钱包余额 0</p>
<p>抵扣说明：</p>
<p>1.余额是钱包充值的虚拟货币，按照1:1的比例进行支付金额的抵扣。<br>2.余额无法直接购买下载，可以购买VIP、付费专栏及课程。</p>
<p><a target="_blank" rel="noopener" href="https://i.csdn.net/#/wallet/balance/recharge">余额充值</a></p>
<p>举报</p>
<p>[![[_resources&#x2F;4bc9ab7d6ff27653410cf36782730aac_MD5.gif]]](<a target="_blank" rel="noopener" href="https://mall.csdn.net/vip?utm_source=25618_vip_blogrighticon">https://mall.csdn.net/vip?utm_source=25618_vip_blogrighticon</a>) [![[_resources&#x2F;35c7362356adf5a11cd3cc47fd01628f_MD5.png]] 点击体验<br>DeepSeekR1满血版](<a target="_blank" rel="noopener" href="https://ai.csdn.net/?utm_source=cknow_pc_blogdetail&spm=1001.2101.3001.10583">https://ai.csdn.net/?utm_source=cknow_pc_blogdetail&amp;spm=1001.2101.3001.10583</a>) ![[_resources&#x2F;90bd0cbf3aff8fdff8bf9b011b581e20_MD5.png]]</p>
<p>程序员都在用的中文IT技术交流社区</p>
<p>![[_resources&#x2F;08a47e60886378fe60a3d9c8f4ae8bc6_MD5.png]]</p>
<p>专业的中文 IT 技术社区，与千万技术人共成长</p>
<p>![[_resources&#x2F;a51be6c085b867a5bd82d8dc1cea9b46_MD5.png]]</p>
<p>关注【CSDN】视频号，行业资讯、技术分享精彩不断，直播好礼送不停！</p>
<p>客服 返回顶部</p>
<p>![[_resources&#x2F;d714522fceeae1639ce39b64defae319_MD5.png]] ![[_resources&#x2F;6864f5e008ef376446b6dec9677397b3_MD5.png]] ![[_resources&#x2F;bc7a22f43a8574862fcec1f7533d6cd9_MD5.png]] ![[_resources&#x2F;bd284e7ea918fd1e453652a859386d65_MD5.png]] ![[_resources&#x2F;1c7a68637852b9868915019ac062ada0_MD5.png]] ![[_resources&#x2F;f90bab9a43a2d915ee8a8d7d17ea1be5_MD5.png]] ![[_resources&#x2F;729b00bb2c82ed3ab6b29dc2e66d89bb_MD5.png]] ![[_resources&#x2F;cc7950399e2b44b22bc3a5917a9e1978_MD5.png]] ![[_resources&#x2F;1f68b8f75ce6b2de004a42d8d4ee8827_MD5.png]]</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%95%99%E7%A8%8B/" class="print-no-link">#教程</a>
      
        <a href="/tags/%E6%91%98%E5%BD%95/" class="print-no-link">#摘录</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Activiti 8.x 工作流入门（含demo）</div>
      <div>https://yhao521.github.io/2025/09/29/摘录/Activiti 8.x 工作流入门（含demo）/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>[[weixin_44954504]]</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年9月29日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/09/29/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F2/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-6/" title="设计模式-6">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">设计模式-6</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/09/29/%E6%91%98%E5%BD%95/adb%E8%BF%9E%E6%8E%A5%E4%B8%8D%E4%B8%8Aandroid%20%E6%8A%A5%E9%94%995037%E7%AB%AF%E5%8F%A3/" title="adb连接不上android 报错5037端口">
                        <span class="hidden-mobile">adb连接不上android 报错5037端口</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>  
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
